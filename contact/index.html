<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MealMate — Contact</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../assets/css/contact.css" />
  </head>
  <body>
    <nav class="topnav" aria-label="Navigation principale">
      <div class="nav-inner">
        <a class="brand" href="../index.html">MealMate</a>
        <ul class="nav-links">
          <li><a href="../about/index.html">À propos</a></li>
          <li><a href="../planner/index.html">Planner</a></li>
          <li><a href="../ingredients/index.html">Ingrédients</a></li>
          <li><a href="../contact/index.html" aria-current="page">Contact</a></li>
        </ul>
        <div class="nav-actions">
          <a class="btn-link" href="../login/index.html">Connexion</a>
          <a class="btn-cta" href="../login/index.html#signup">Inscription</a>
        </div>
      </div>
    </nav>

    <div class="contact-wrapper">
      <div class="bubble"></div>
      <header class="contact-header">
        <h1>Contact</h1>
        <p>Envoyez-nous un message.</p>
      </header>

      <main class="contact-card" role="form" aria-label="Formulaire de contact">
        <form id="contactForm" novalidate>
          <div class="grid">
            <div class="field">
              <label for="firstName">Prénom <span class="req">!</span></label>
              <input id="firstName" name="firstName" type="text" placeholder="Votre prénom" autocomplete="given-name" required minlength="2" />
            </div>
            <div class="field">
              <label for="lastName">Nom </label>
              <input id="lastName" name="lastName" type="text" placeholder="Votre nom" autocomplete="family-name" required minlength="2" />
            </div>
          </div>

          <div class="field">
            <label for="email">Email <span class="req">!</span></label>
            <input id="email" name="email" type="email" placeholder="vous@example.com" autocomplete="email" required />
          </div>

          <div class="field">
            <label for="category">Catégorie <span class="req">!</span></label>
            <select id="category" name="category" required>
              <option value="" selected disabled>Choisissez une catégorie</option>
              <option value="support">Support / Aide</option>
              <option value="bug">Bug / Problème technique</option>
              <option value="feedback">Suggestion / Feedback</option>
              <option value="partnership">Partenariat</option>
              <option value="account">Compte / Connexion</option>
              <option value="other">Autre</option>
            </select>
          </div>

          <div class="field">
            <label for="subject">Sujet <span class="req">!</span></label>
            <input id="subject" name="subject" type="text" placeholder="Sujet" maxlength="120" required />
          </div>

          <div class="field">
            <label for="message">Message <span class="req">!</span></label>
            <textarea id="message" name="message" rows="6" placeholder="Écrivez votre message..." required minlength="10" maxlength="500"></textarea>
            <div class="meter-row">
              <div class="char-meter"><span id="charProgress"></span></div>
              <small class="muted"><span id="charCount">0</span>/500</small>
            </div>
          </div>

          <p class="error" id="formError" aria-live="polite"></p>
          <div class="actions">
            <button type="submit" class="btn">
              <span class="btn-label">Envoyer</span>
              <span class="btn-spinner" aria-hidden="true"></span>
            </button>
          </div>
        </form>
      </main>

      <footer class="contact-footer">
        <a href="../index.html" class="back-link">← Retour à l'accueil</a>
      </footer>
    </div>

    <script>
      const form = document.getElementById('contactForm');
      const errorBox = document.getElementById('formError');
      const msg = document.getElementById('message');
      const charCount = document.getElementById('charCount');
      const charProgress = document.getElementById('charProgress');

      function updateCounters() {
        const max = 500;
        const len = Math.min(msg.value.length, max);
        charCount.textContent = len;
        const pct = Math.round((len / max) * 100);
        charProgress.style.width = pct + '%';
      }

      msg.addEventListener('input', updateCounters);
      updateCounters();

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        errorBox.textContent = '';
        const btn = form.querySelector('.btn');
        btn.classList.add('loading');
        if (!form.checkValidity()) {
          errorBox.textContent = 'Complétez les champs requis.';
          btn.classList.remove('loading');
          return;
        }
        setTimeout(() => {
          btn.classList.remove('loading');
          form.reset();
          updateCounters();
        }, 800);
      });
    </script>
  </body>
</html>