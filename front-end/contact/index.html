<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MealMate ‚Äî Contact</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../assets/css/contact.css" />
  </head>
  <body>
    <nav class="topnav" aria-label="Navigation principale">
      <div class="nav-inner">
        <a class="brand" href="../index.html">
          <img class="logo" src="../assets/img/image (25).svg" alt="MealMate" />
          <span>MealMate</span>
        </a>
        <ul class="nav-links">
          <li><a href="../about/index.html">√Ä propos</a></li>
          <li><a href="../pricing/index.html">Tarifs</a></li>
          <li><a href="../planner/index.html">Planner</a></li>
          <li><a href="../ingredients/index.html">Ingr√©dients</a></li>
          <li><a href="../contact/index.html" aria-current="page">Contact</a></li>
        </ul>
        <div class="nav-actions">
          <a class="btn-link" href="../login/index.html">Connexion</a>
          <a class="btn-cta" href="../login/index.html#signup">Inscription</a>
        </div>
      </div>
    </nav>

    <div class="contact-wrapper">
      <div class="bubble"></div>
      <header class="contact-header">
        <h1>Contact</h1>
        <p>Envoyez-nous un message.</p>
      </header>

      <main class="contact-card" role="form" aria-label="Formulaire de contact">
        <form id="contactForm" novalidate>
          <div class="grid">
            <div class="field">
              <label for="firstName">Pr√©nom <span class="req">!</span></label>
              <input id="firstName" name="firstName" type="text" placeholder="Votre pr√©nom" autocomplete="given-name" required minlength="2" />
              <span class="validation-hint" id="firstNameHint"></span>
            </div>
            <div class="field">
              <label for="lastName">Nom </label>
              <input id="lastName" name="lastName" type="text" placeholder="Votre nom" autocomplete="family-name" required minlength="2" />
              <span class="validation-hint" id="lastNameHint"></span>
            </div>
          </div>

          <div class="field">
            <label for="email">Email <span class="req">!</span></label>
            <input id="email" name="email" type="email" placeholder="vous@example.com" autocomplete="email" required />
            <span class="validation-hint" id="emailHint"></span>
          </div>

          <div class="field">
            <label for="category">Cat√©gorie <span class="req">!</span></label>
            <select id="category" name="category" required>
              <option value="" selected disabled>Choisissez une cat√©gorie</option>
              <option value="support">Support / Aide</option>
              <option value="bug">Bug / Probl√®me technique</option>
              <option value="feedback">Suggestion / Feedback</option>
              <option value="partnership">Partenariat</option>
              <option value="account">Compte / Connexion</option>
              <option value="other">Autre</option>
            </select>
            <span class="validation-hint" id="categoryHint"></span>
          </div>

          <div class="field">
            <label for="subject">Sujet <span class="req">!</span></label>
            <input id="subject" name="subject" type="text" placeholder="Sujet" maxlength="120" required />
            <span class="validation-hint" id="subjectHint"></span>
          </div>

          <div class="field">
            <label for="message">Message <span class="req">!</span></label>
            <textarea id="message" name="message" rows="6" placeholder="√âcrivez votre message..." required minlength="10" maxlength="500"></textarea>
            <div class="meter-row">
              <div class="char-meter"><span id="charProgress"></span></div>
              <small class="muted"><span id="charCount">0</span>/500</small>
            </div>
            <span class="validation-hint" id="messageHint"></span>
          </div>

          <p class="error" id="formError" aria-live="polite"></p>
          <div class="actions">
            <button type="submit" class="btn" id="submitBtn">
              <span class="btn-label">Envoyer</span>
              <span class="btn-spinner" aria-hidden="true"></span>
            </button>
          </div>
        </form>

        <div class="social-media">
          <h3>Suivez-nous</h3>
          <div class="social-icons">
            <a href="#" aria-label="Instagram" class="social-icon instagram">üì∑</a>
            <a href="#" aria-label="LinkedIn" class="social-icon linkedin">üíº</a>
            <a href="#" aria-label="Twitter" class="social-icon twitter">üê¶</a>
            <a href="#" aria-label="Facebook" class="social-icon facebook">üë•</a>
          </div>
        </div>

        <div class="map-container">
          <h3>Notre localisation</h3>
          <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2624.9914406081496!2d2.292292615509644!3d48.85837007928746!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47e66e2964e34e2d%3A0x8ddca9ee380ef7e0!2sTour%20Eiffel!5e0!3m2!1sfr!2sfr!4v1234567890123!5m2!1sfr!2sfr"
            width="100%"
            height="250"
            style="border:0; border-radius: 12px;"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade">
          </iframe>
        </div>
      </main>

      <footer class="contact-footer">
        <a href="../index.html" class="back-link">‚Üê Retour √† l'accueil</a>
      </footer>
    </div>

    <!-- Success message -->
    <div class="success-message" id="successMessage">
      Message envoy√© avec succ√®s üòé
    </div>

    <!-- Scroll to top button -->
    <button class="scroll-to-top" id="scrollToTop" aria-label="Retour en haut">
      ‚Üë
    </button>

    <!-- Chatbot bubble -->
    <div class="chatbot-bubble" id="chatbotBubble" aria-label="Chatbot">
      üí¨
    </div>

    <script>
      const form = document.getElementById('contactForm');
      const errorBox = document.getElementById('formError');
      const msg = document.getElementById('message');
      const charCount = document.getElementById('charCount');
      const charProgress = document.getElementById('charProgress');
      const submitBtn = document.getElementById('submitBtn');
      const successMessage = document.getElementById('successMessage');
      const scrollToTop = document.getElementById('scrollToTop');
      const chatbotBubble = document.getElementById('chatbotBubble');
      const bubble = document.querySelector('.bubble');

      // Validation hints
      const firstName = document.getElementById('firstName');
      const lastName = document.getElementById('lastName');
      const email = document.getElementById('email');
      const category = document.getElementById('category');
      const subject = document.getElementById('subject');

      function updateCounters() {
        const max = 500;
        const len = Math.min(msg.value.length, max);
        charCount.textContent = len;
        const pct = Math.round((len / max) * 100);
        charProgress.style.width = pct + '%';
      }

      function validateField(field, hintId, validator) {
        const hint = document.getElementById(hintId);
        if (field.value.trim() === '' && !field.required) {
          hint.textContent = '';
          field.classList.remove('valid', 'invalid');
          return true;
        }
        if (validator(field.value)) {
          hint.textContent = '‚úÖ Valide';
          hint.className = 'validation-hint valid';
          field.classList.add('valid');
          field.classList.remove('invalid');
          return true;
        } else {
          hint.textContent = '';
          hint.className = 'validation-hint';
          field.classList.remove('valid', 'invalid');
          return false;
        }
      }

      // Live validation
      firstName.addEventListener('input', () => {
        validateField(firstName, 'firstNameHint', (v) => v.length >= 2);
      });

      lastName.addEventListener('input', () => {
        validateField(lastName, 'lastNameHint', (v) => v.length >= 2);
      });

      email.addEventListener('input', () => {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (email.value.trim() === '') {
          document.getElementById('emailHint').textContent = '';
          email.classList.remove('valid', 'invalid');
        } else {
          const hint = document.getElementById('emailHint');
          if (emailRegex.test(email.value)) {
            hint.textContent = '‚úÖ Email valide';
            hint.className = 'validation-hint valid';
            email.classList.add('valid');
            email.classList.remove('invalid');
          } else {
            hint.textContent = '';
            hint.className = 'validation-hint';
            email.classList.remove('valid', 'invalid');
          }
        }
      });

      category.addEventListener('change', () => {
        validateField(category, 'categoryHint', (v) => v !== '');
      });

      subject.addEventListener('input', () => {
        validateField(subject, 'subjectHint', (v) => v.length >= 3);
      });

      msg.addEventListener('input', () => {
        updateCounters();
        const hint = document.getElementById('messageHint');
        if (msg.value.length >= 10) {
          hint.textContent = '‚úÖ Message valide';
          hint.className = 'validation-hint valid';
        } else {
          hint.textContent = '';
          hint.className = 'validation-hint';
        }
      });

      updateCounters();

      // Form fade-in animation
      const contactCard = document.querySelector('.contact-card');
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
          }
        });
      }, { threshold: 0.1 });
      contactCard.style.opacity = '0';
      contactCard.style.transform = 'translateY(20px)';
      contactCard.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
      observer.observe(contactCard);

      // Parallax effect
      document.addEventListener('mousemove', (e) => {
        const x = (e.clientX / window.innerWidth - 0.5) * 20;
        const y = (e.clientY / window.innerHeight - 0.5) * 20;
        bubble.style.transform = `translate(${x}px, ${y}px)`;
      });

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        errorBox.textContent = '';
        submitBtn.disabled = true;
        submitBtn.classList.add('loading');
        
        if (!form.checkValidity()) {
          errorBox.textContent = 'Compl√©tez les champs requis.';
          submitBtn.classList.remove('loading');
          submitBtn.disabled = false;
          return;
        }
        
        setTimeout(() => {
          submitBtn.classList.remove('loading');
          submitBtn.disabled = false;
          form.reset();
          updateCounters();
          // Show success message
          successMessage.classList.add('show');
          setTimeout(() => {
            successMessage.classList.remove('show');
          }, 3000);
        }, 800);
      });

      // Scroll to top
      scrollToTop.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });

      window.addEventListener('scroll', () => {
        if (window.pageYOffset > 300) {
          scrollToTop.classList.add('visible');
        } else {
          scrollToTop.classList.remove('visible');
        }
      });

      // Chatbot bubble click
      chatbotBubble.addEventListener('click', () => {
        alert('Chatbot en d√©veloppement ! üöÄ');
      });
    </script>
  </body>
</html>